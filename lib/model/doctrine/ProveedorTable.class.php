<?php

/**
 * ProveedorTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class ProveedorTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object ProveedorTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Proveedor');
    }

    public function retrieveConJoins(Doctrine_Query $q)
    {
      $rootAlias = $q->getRootAlias();
      $q->where($rootAlias . ".id not in (13, 99)");
      return $q; 
    }
		
    public function ProveedorZona(){
			$id = sfContext::getInstance()->getUser()->getGuardUser()->getId();
			$q = Doctrine_Core::getTable('Proveedor')->createQuery('q');
      $q->where('id not in (13, 99) and exists(select 1 from usuario_zona where zona_id = 1 and usuario = '.$id.')');
      $q->orWhere('id = 99 and not exists(select 1 from usuario_zona where zona_id = 1 and usuario = '.$id.')');			
      return $q;
    }		
}